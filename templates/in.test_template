# test of pair style with bond_style table and dihedral nharmonic

units real
dimension 3
boundary p p p
atom_style      full


bond_style      {% for p in style.bond %} {{p}} {%- endfor %} 
angle_style     {% for p in style.angle %} {{p}} {%- endfor %}
dihedral_style  {% for p in style.dihedral %} {{p}} {%- endfor %}  

pair_style      hybrid/overlay mie/cut 14.0 coul/long 14.0
pair_modify tail yes shift no mix arithmetic


read_data       {{path}}

{% for p in pairs %}
pair_coeff  {{p.i}} {{p.j}}  mie/cut {{p.epsilon}} {{p.sigma}} {{p.m}} 6.0
{%- endfor %}

pair_coeff * * coul/long

#kspace_style none
#kspace_style    ewald/disp 0.0001
kspace_style pppm 1.0e-4
 

variable pe equal pe
variable ke equal ke
variable etotal equal etotal
variable evdwl equal evdwl
variable ecoul equal ecoul
variable elong equal elong
variable ebond equal ebond
variable eangle equal eangle
variable edihed equal edihed
variable eimp equal eimp
variable emol equal emol
variable especial equal especial

variable vol equal vol
variable press equal press
variable temp equal temp
variable dens equal density
variable boxlength equal vol^(1/3)

# ------------- output ---------------
variable        to_screen_every     equal       1
variable        to_file_every       equal       1
variable        step                equal       step
variable        time                equal       time

# ============= THERMO OUTPUT / FILE OUTPUT =============
thermo          ${to_screen_every}
thermo_style    custom step pe ke temp press vol v_dens ebond eangle edihed evdwl ecoul elong v_boxlength

run 0